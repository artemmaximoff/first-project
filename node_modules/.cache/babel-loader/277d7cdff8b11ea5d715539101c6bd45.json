{"ast":null,"code":"import _regeneratorRuntime from\"D:/react_projects/01-first-project/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/react_projects/01-first-project/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"D:/react_projects/01-first-project/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"D:/react_projects/01-first-project/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{usersAPI}from'../api/api';var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET_USERS';var SET_CURRENT_PAGE='CURRENT_PAGE';var SET_TOTAL_USER_COUNT='TOTAL_USER_COUNT';var TOGGLE_IS_FETCHING='TOGGLE_IS_FETCHING';var TOGGLE_IS_FOLLWING_PROGRESS='TOGGLE_IS_FOLLWING_PROGRES';var initialState={users:[],totalUsersCount:0,pageSize:10,currentPage:1,isFetching:true,follwingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(u){if(u.id===action.userId){return _objectSpread(_objectSpread({},u),{},{followed:true});}return u;})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(u){if(u.id===action.userId){return _objectSpread(_objectSpread({},u),{},{followed:false});}return u;})});case SET_USERS:return _objectSpread(_objectSpread({},state),{},{users:_toConsumableArray(action.users)});case SET_CURRENT_PAGE:return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});case SET_TOTAL_USER_COUNT:return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.totalUsersCount});case TOGGLE_IS_FETCHING:return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});case TOGGLE_IS_FOLLWING_PROGRESS:return _objectSpread(_objectSpread({},state),{},{follwingInProgress:action.isFetching?[].concat(_toConsumableArray(state.follwingInProgress),[action.userId]):state.follwingInProgress.filter(function(id){return id!=action.userId;})});default:return state;}};export var followSuccessed=function followSuccessed(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccessed=function unfollowSuccessed(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setTotalUsersCount=function setTotalUsersCount(totalUsersCount){return{type:SET_TOTAL_USER_COUNT,totalUsersCount:totalUsersCount};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var togglefollwingInProgress=function togglefollwingInProgress(isFetching,userId){return{type:TOGGLE_IS_FOLLWING_PROGRESS,isFetching:isFetching,userId:userId};};export var getUsers=function getUsers(currentPage,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));dispatch(setCurrentPage(currentPage));_context.next=4;return usersAPI.getUsers(currentPage,pageSize);case 4:response=_context.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(response.data.items));dispatch(setTotalUsersCount(response.data.totalCount));case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(togglefollwingInProgress(true,userId));_context2.next=3;return usersAPI.follow(userId);case 3:response=_context2.sent;if(response.data.resultCode==0){dispatch(followSuccessed(userId));}dispatch(togglefollwingInProgress(false,userId));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var unfollow=function unfollow(userId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(togglefollwingInProgress(true,userId));_context3.next=3;return usersAPI.unfollow(userId);case 3:response=_context3.sent;if(response.data.resultCode==0){dispatch(unfollowSuccessed(userId));}dispatch(togglefollwingInProgress(false,userId));case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"names":["usersAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USER_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLWING_PROGRESS","initialState","users","totalUsersCount","pageSize","currentPage","isFetching","follwingInProgress","usersReducer","state","action","type","map","u","id","userId","followed","filter","followSuccessed","unfollowSuccessed","setUsers","setCurrentPage","setTotalUsersCount","toggleIsFetching","togglefollwingInProgress","getUsers","dispatch","response","data","items","totalCount","follow","resultCode","unfollow"],"sources":["D:/react_projects/01-first-project/my-app/src/redux/usersReducer.js"],"sourcesContent":["import { usersAPI } from '../api/api';\r\n\r\nconst FOLLOW = 'FOLLOW'\r\nconst UNFOLLOW = 'UNFOLLOW'\r\nconst SET_USERS = 'SET_USERS'\r\nconst SET_CURRENT_PAGE = 'CURRENT_PAGE'\r\nconst SET_TOTAL_USER_COUNT = 'TOTAL_USER_COUNT'\r\nconst TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING'\r\nconst TOGGLE_IS_FOLLWING_PROGRESS = 'TOGGLE_IS_FOLLWING_PROGRES'\r\n\r\nlet initialState = {\r\n    users: [],\r\n    totalUsersCount: 0,\r\n    pageSize: 10,\r\n    currentPage: 1,\r\n    isFetching: true,\r\n    follwingInProgress: []\r\n\r\n};\r\n\r\nconst usersReducer = (state = initialState, action) => {\r\n\r\n    switch (action.type) {\r\n        case FOLLOW:\r\n            return {\r\n                ...state,\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userId) {\r\n                        return { ...u, followed: true }\r\n                    }\r\n                    return u;\r\n                })\r\n            }\r\n        case UNFOLLOW:\r\n            return {\r\n                ...state,\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userId) {\r\n                        return { ...u, followed: false }\r\n                    }\r\n                    return u;\r\n                })\r\n            }\r\n        case SET_USERS:\r\n            return {\r\n                ...state,\r\n                users: [...action.users]\r\n            }\r\n        case SET_CURRENT_PAGE:\r\n            return {\r\n                ...state,\r\n                currentPage: action.currentPage\r\n            }\r\n\r\n        case SET_TOTAL_USER_COUNT:\r\n            return {\r\n                ...state,\r\n                totalUsersCount: action.totalUsersCount\r\n            }\r\n        case TOGGLE_IS_FETCHING:\r\n            return {\r\n                ...state,\r\n                isFetching: action.isFetching\r\n            }\r\n        case TOGGLE_IS_FOLLWING_PROGRESS:\r\n            return {\r\n                ...state,\r\n                follwingInProgress: action.isFetching ? [...state.follwingInProgress, action.userId] : state.follwingInProgress.filter(id => id != action.userId)\r\n            }\r\n\r\n        default:\r\n            return state;\r\n\r\n    }\r\n\r\n}\r\n\r\nexport const followSuccessed = (userId) => ({ type: FOLLOW, userId });\r\nexport const unfollowSuccessed = (userId) => ({ type: UNFOLLOW, userId });\r\nexport const setUsers = (users) => ({ type: SET_USERS, users });\r\nexport const setCurrentPage = (currentPage) => ({ type: SET_CURRENT_PAGE, currentPage });\r\nexport const setTotalUsersCount = (totalUsersCount) => ({ type: SET_TOTAL_USER_COUNT, totalUsersCount });\r\nexport const toggleIsFetching = (isFetching) => ({ type: TOGGLE_IS_FETCHING, isFetching });\r\nexport const togglefollwingInProgress = (isFetching, userId) => ({\r\n    type: TOGGLE_IS_FOLLWING_PROGRESS,\r\n    isFetching,\r\n    userId\r\n});\r\nexport const getUsers = (currentPage, pageSize) => async (dispatch) => {\r\n    dispatch(toggleIsFetching(true));\r\n    dispatch(setCurrentPage(currentPage));\r\n    let response = await usersAPI.getUsers(currentPage, pageSize);\r\n    dispatch(toggleIsFetching(false))\r\n    dispatch(setUsers(response.data.items))\r\n    dispatch(setTotalUsersCount(response.data.totalCount))\r\n}\r\n\r\nexport const follow = (userId) => async (dispatch) => {\r\n    dispatch(togglefollwingInProgress(true, userId));\r\n    let response = await usersAPI.follow(userId);\r\n    if (response.data.resultCode == 0) {\r\n        dispatch(followSuccessed(userId))\r\n    }\r\n    dispatch(togglefollwingInProgress(false, userId))\r\n\r\n}\r\nexport const unfollow = (userId) => async (dispatch) => {\r\n    dispatch(togglefollwingInProgress(true, userId));\r\n    let response = await usersAPI.unfollow(userId);\r\n    if (response.data.resultCode == 0) {\r\n        dispatch(unfollowSuccessed(userId))\r\n    }\r\n    dispatch(togglefollwingInProgress(false, userId))\r\n}\r\n\r\n\r\nexport default usersReducer;\r\n\r\n\r\n\r\n"],"mappings":"mhBAAA,OAASA,QAAT,KAAyB,YAAzB,CAEA,GAAMC,OAAM,CAAG,QAAf,CACA,GAAMC,SAAQ,CAAG,UAAjB,CACA,GAAMC,UAAS,CAAG,WAAlB,CACA,GAAMC,iBAAgB,CAAG,cAAzB,CACA,GAAMC,qBAAoB,CAAG,kBAA7B,CACA,GAAMC,mBAAkB,CAAG,oBAA3B,CACA,GAAMC,4BAA2B,CAAG,4BAApC,CAEA,GAAIC,aAAY,CAAG,CACfC,KAAK,CAAE,EADQ,CAEfC,eAAe,CAAE,CAFF,CAGfC,QAAQ,CAAE,EAHK,CAIfC,WAAW,CAAE,CAJE,CAKfC,UAAU,CAAE,IALG,CAMfC,kBAAkB,CAAE,EANL,CAAnB,CAUA,GAAMC,aAAY,CAAG,QAAfA,aAAe,EAAkC,IAAjCC,MAAiC,2DAAzBR,YAAyB,IAAXS,OAAW,2CAEnD,OAAQA,MAAM,CAACC,IAAf,EACI,IAAKjB,OAAL,CACI,sCACOe,KADP,MAEIP,KAAK,CAAEO,KAAK,CAACP,KAAN,CAAYU,GAAZ,CAAgB,SAAAC,CAAC,CAAI,CACxB,GAAIA,CAAC,CAACC,EAAF,GAASJ,MAAM,CAACK,MAApB,CAA4B,CACxB,sCAAYF,CAAZ,MAAeG,QAAQ,CAAE,IAAzB,GACH,CACD,MAAOH,EAAP,CACH,CALM,CAFX,GASJ,IAAKlB,SAAL,CACI,sCACOc,KADP,MAEIP,KAAK,CAAEO,KAAK,CAACP,KAAN,CAAYU,GAAZ,CAAgB,SAAAC,CAAC,CAAI,CACxB,GAAIA,CAAC,CAACC,EAAF,GAASJ,MAAM,CAACK,MAApB,CAA4B,CACxB,sCAAYF,CAAZ,MAAeG,QAAQ,CAAE,KAAzB,GACH,CACD,MAAOH,EAAP,CACH,CALM,CAFX,GASJ,IAAKjB,UAAL,CACI,sCACOa,KADP,MAEIP,KAAK,oBAAMQ,MAAM,CAACR,KAAb,CAFT,GAIJ,IAAKL,iBAAL,CACI,sCACOY,KADP,MAEIJ,WAAW,CAAEK,MAAM,CAACL,WAFxB,GAKJ,IAAKP,qBAAL,CACI,sCACOW,KADP,MAEIN,eAAe,CAAEO,MAAM,CAACP,eAF5B,GAIJ,IAAKJ,mBAAL,CACI,sCACOU,KADP,MAEIH,UAAU,CAAEI,MAAM,CAACJ,UAFvB,GAIJ,IAAKN,4BAAL,CACI,sCACOS,KADP,MAEIF,kBAAkB,CAAEG,MAAM,CAACJ,UAAP,8BAAwBG,KAAK,CAACF,kBAA9B,GAAkDG,MAAM,CAACK,MAAzD,GAAmEN,KAAK,CAACF,kBAAN,CAAyBU,MAAzB,CAAgC,SAAAH,EAAE,QAAIA,GAAE,EAAIJ,MAAM,CAACK,MAAjB,EAAlC,CAF3F,GAKJ,QACI,MAAON,MAAP,CAjDR,CAqDH,CAvDD,CAyDA,MAAO,IAAMS,gBAAe,CAAG,QAAlBA,gBAAkB,CAACH,MAAD,QAAa,CAAEJ,IAAI,CAAEjB,MAAR,CAAgBqB,MAAM,CAANA,MAAhB,CAAb,EAAxB,CACP,MAAO,IAAMI,kBAAiB,CAAG,QAApBA,kBAAoB,CAACJ,MAAD,QAAa,CAAEJ,IAAI,CAAEhB,QAAR,CAAkBoB,MAAM,CAANA,MAAlB,CAAb,EAA1B,CACP,MAAO,IAAMK,SAAQ,CAAG,QAAXA,SAAW,CAAClB,KAAD,QAAY,CAAES,IAAI,CAAEf,SAAR,CAAmBM,KAAK,CAALA,KAAnB,CAAZ,EAAjB,CACP,MAAO,IAAMmB,eAAc,CAAG,QAAjBA,eAAiB,CAAChB,WAAD,QAAkB,CAAEM,IAAI,CAAEd,gBAAR,CAA0BQ,WAAW,CAAXA,WAA1B,CAAlB,EAAvB,CACP,MAAO,IAAMiB,mBAAkB,CAAG,QAArBA,mBAAqB,CAACnB,eAAD,QAAsB,CAAEQ,IAAI,CAAEb,oBAAR,CAA8BK,eAAe,CAAfA,eAA9B,CAAtB,EAA3B,CACP,MAAO,IAAMoB,iBAAgB,CAAG,QAAnBA,iBAAmB,CAACjB,UAAD,QAAiB,CAAEK,IAAI,CAAEZ,kBAAR,CAA4BO,UAAU,CAAVA,UAA5B,CAAjB,EAAzB,CACP,MAAO,IAAMkB,yBAAwB,CAAG,QAA3BA,yBAA2B,CAAClB,UAAD,CAAaS,MAAb,QAAyB,CAC7DJ,IAAI,CAAEX,2BADuD,CAE7DM,UAAU,CAAVA,UAF6D,CAG7DS,MAAM,CAANA,MAH6D,CAAzB,EAAjC,CAKP,MAAO,IAAMU,SAAQ,CAAG,QAAXA,SAAW,CAACpB,WAAD,CAAcD,QAAd,mGAA2B,iBAAOsB,QAAP,iIAC/CA,QAAQ,CAACH,gBAAgB,CAAC,IAAD,CAAjB,CAAR,CACAG,QAAQ,CAACL,cAAc,CAAChB,WAAD,CAAf,CAAR,CAF+C,sBAG1BZ,SAAQ,CAACgC,QAAT,CAAkBpB,WAAlB,CAA+BD,QAA/B,CAH0B,QAG3CuB,QAH2C,eAI/CD,QAAQ,CAACH,gBAAgB,CAAC,KAAD,CAAjB,CAAR,CACAG,QAAQ,CAACN,QAAQ,CAACO,QAAQ,CAACC,IAAT,CAAcC,KAAf,CAAT,CAAR,CACAH,QAAQ,CAACJ,kBAAkB,CAACK,QAAQ,CAACC,IAAT,CAAcE,UAAf,CAAnB,CAAR,CAN+C,sDAA3B,gEAAjB,CASP,MAAO,IAAMC,OAAM,CAAG,QAATA,OAAS,CAAChB,MAAD,oGAAY,kBAAOW,QAAP,qIAC9BA,QAAQ,CAACF,wBAAwB,CAAC,IAAD,CAAOT,MAAP,CAAzB,CAAR,CAD8B,uBAETtB,SAAQ,CAACsC,MAAT,CAAgBhB,MAAhB,CAFS,QAE1BY,QAF0B,gBAG9B,GAAIA,QAAQ,CAACC,IAAT,CAAcI,UAAd,EAA4B,CAAhC,CAAmC,CAC/BN,QAAQ,CAACR,eAAe,CAACH,MAAD,CAAhB,CAAR,CACH,CACDW,QAAQ,CAACF,wBAAwB,CAAC,KAAD,CAAQT,MAAR,CAAzB,CAAR,CAN8B,wDAAZ,kEAAf,CASP,MAAO,IAAMkB,SAAQ,CAAG,QAAXA,SAAW,CAAClB,MAAD,oGAAY,kBAAOW,QAAP,qIAChCA,QAAQ,CAACF,wBAAwB,CAAC,IAAD,CAAOT,MAAP,CAAzB,CAAR,CADgC,uBAEXtB,SAAQ,CAACwC,QAAT,CAAkBlB,MAAlB,CAFW,QAE5BY,QAF4B,gBAGhC,GAAIA,QAAQ,CAACC,IAAT,CAAcI,UAAd,EAA4B,CAAhC,CAAmC,CAC/BN,QAAQ,CAACP,iBAAiB,CAACJ,MAAD,CAAlB,CAAR,CACH,CACDW,QAAQ,CAACF,wBAAwB,CAAC,KAAD,CAAQT,MAAR,CAAzB,CAAR,CANgC,wDAAZ,kEAAjB,CAUP,cAAeP,aAAf"},"metadata":{},"sourceType":"module"}